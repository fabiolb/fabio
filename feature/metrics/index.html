<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keywords" content="">

    <title>Metrics</title>

    
    <link href="/css/theDocs.all.min.css" rel="stylesheet">
    <link href="/css/skin/skin-blue.min.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">

    
    

    
    <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
    <link rel="manifest" href="/img/manifest.json">
    <link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#ffffff">
  </head>

  <body data-spy="scroll" data-target=".sidebar" data-offset="400">
    
    <a id="top" href="#"></a>

    <header class="site-header sticky">
      <nav class="navbar navbar-default">
        <div class="container">

          
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar" aria-expanded="true" aria-controls="navbar">
              <span class="glyphicon glyphicon-option-vertical"></span>
            </button>

            <button type="button" class="navbar-toggle for-sidebar" data-toggle="offcanvas">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            <a class="navbar-brand" href="/"><img src="/img/logo-bw.svg" alt="logo"></a>
          </div>
          

          
          <div id="navbar" class="navbar-collapse collapse" aria-expanded="true" role="banner">
            <ul class="nav navbar-nav navbar-right">
              <li><a href="/quickstart/">Quickstart</a></li>
              <li><a href="/deploy/">Deployment</a></li>
              <li><a href="/feature/">Features</a></li>
              <li><a href="/ref/">Reference</a></li>
              <li><a href="/faq/">FAQ</a></li>
              <li><a target="_blank" href="https://twitter.com/search?q=%23fabiolb"><i class="fa fa-twitter fa-2x" aria-hidden="true"></i></a></li>
              <li><a target="_blank" href="https://github.com/fabiolb/fabio"><i class="fa fa-github fa-2x" aria-hidden="true"></i></a></li>
            </ul>
          </div>
          

        </div>
      </nav>

    </header>



<main class="container">
  <div class="row">
    
<aside class="col-sm-3 sidebar sidebar-line">

  <ul class="nav sidenav dropable ">
    
    
    <li>
      <a class="" href="https://fabiolb.net/quickstart/">Quickstart</a>
      
    </li>
    
    
    <li>
      <a class="" href="https://fabiolb.net/feature/">Features</a>
      
      <ul class="open">
      
        <li><a href="https://fabiolb.net/feature/access-control/">Access Control</a></li>
      
        <li><a href="https://fabiolb.net/feature/access-logging/">Access Logging</a></li>
      
        <li><a href="https://fabiolb.net/feature/authorization/">Authorization</a></li>
      
        <li><a href="https://fabiolb.net/feature/bgp/">BGP</a></li>
      
        <li><a href="https://fabiolb.net/feature/certificate-stores/">Certificate Stores</a></li>
      
        <li><a href="https://fabiolb.net/feature/docker/">Docker Support</a></li>
      
        <li><a href="https://fabiolb.net/feature/dynamic-reloading/">Dynamic Reloading</a></li>
      
        <li><a href="https://fabiolb.net/feature/graceful-shutdown/">Graceful Shutdown</a></li>
      
        <li><a href="https://fabiolb.net/feature/grpc-proxy/">GRPC Proxy</a></li>
      
        <li><a href="https://fabiolb.net/feature/http-compression/">HTTP Compression</a></li>
      
        <li><a href="https://fabiolb.net/feature/http-headers/">HTTP Header Support</a></li>
      
        <li><a href="https://fabiolb.net/feature/http-path-prepending/">HTTP Path Prepending</a></li>
      
        <li><a href="https://fabiolb.net/feature/http-path-stripping/">HTTP Path Stripping</a></li>
      
        <li><a href="https://fabiolb.net/feature/http-redirects/">HTTP Redirects</a></li>
      
        <li><a href="https://fabiolb.net/feature/https-tcp-sni-proxy/">HTTPS TCP-SNI Proxy</a></li>
      
        <li><a href="https://fabiolb.net/feature/https-upstream/">HTTPS Upstream</a></li>
      
        <li><a class="active" href="https://fabiolb.net/feature/metrics/">Metrics</a></li>
      
        <li><a href="https://fabiolb.net/feature/proxy-protocol/">PROXY Protocol Support</a></li>
      
        <li><a href="https://fabiolb.net/feature/sse/">Server Sent Events (SSE)</a></li>
      
        <li><a href="https://fabiolb.net/feature/tcp-dynamic-proxy/">TCP Dynamic Proxy</a></li>
      
        <li><a href="https://fabiolb.net/feature/tcp-proxy/">TCP Proxy</a></li>
      
        <li><a href="https://fabiolb.net/feature/tcp-sni-proxy/">TCP-SNI Proxy</a></li>
      
        <li><a href="https://fabiolb.net/feature/traffic-shaping/">Traffic Shaping</a></li>
      
        <li><a href="https://fabiolb.net/feature/vault/">Vault Support</a></li>
      
        <li><a href="https://fabiolb.net/feature/web-ui/">Web UI</a></li>
      
        <li><a href="https://fabiolb.net/feature/websockets/">Websockets</a></li>
      
      </ul>
      
    </li>
    
    
    <li>
      <a class="" href="https://fabiolb.net/deploy/">Deployment</a>
      
    </li>
    
    
    <li>
      <a class="" href="https://fabiolb.net/cfg/">Config Language</a>
      
    </li>
    
    
    <li>
      <a class="" href="https://fabiolb.net/ref/">Reference</a>
      
    </li>
    
    
    <li>
      <a class="" href="https://fabiolb.net/faq/">FAQ</a>
      
    </li>
    
    
    <li>
      <a class="" href="https://fabiolb.net/contrib/">Contributing</a>
      
    </li>
    
    
    <li>
      <a class="" href="https://fabiolb.net/code-of-conduct/">Code of Conduct</a>
      
    </li>
    
    
    <li>
      <a class="" href="https://fabiolb.net/contact/">Contact</a>
      
    </li>
    
  </ul>

</aside>


    
    <article class="col-sm-9 main-content" role="main">

      
      <section>
        <h2>Metrics</h2>
        <p>Fabio collects metrics per route and service instance as well as running totals
to avoid computing large amounts of metrics. The metrics can be sent to
<a href="http://www.circonus.com">Circonus</a>, <a href="https://graphiteapp.org">Graphite</a>,
<a href="https://github.com/etsy/statsd">StatsD</a>, <a href="https://www.datadoghq.com">DataDog</a>
(via statsd - or since v1.6.0 to native protocol with tag support) or stdout. See the <code>metrics.*</code>
options in the <a href="https://github.com/eBay/fabio/blob/master/fabio.properties">fabio.properties</a>
file.  Prometheus is also possible, but it works the reverse of the other metrics platforms.
Instead of pushing data to a metrics server, prometheus expects to poll an endpoint for changes.</p>
<h3 id="configuring-prometheus-metrics">Configuring Prometheus Metrics</h3>
<p>To configure prometheus metrics, you need to do the following:</p>
<ol>
<li>You must specify that prometheus is the <a href="/ref/metrics.target/">metrics.target</a></li>
<li>You must configure a listener in <a href="/ref/proxy.addr/">proxy.addr</a> with <code>proto=prometheus</code></li>
<li>(optional) override the
<a href="/ref/metrics.prometheus.path/">metrics.prometheus.path</a>,
<a href="/ref/metrics.prometheus.subsystem/">metrics.prometheus.subsystem</a>,
and <a href="/ref/metrics.prometheus.buckets/">metrics.prometheus.buckets</a>.</li>
</ol>
<h3 id="metrics-info-for-non-tagged-backends-such-as-circonus-and-statsd_raw">Metrics info (for non-tagged backends, such as circonus and statsd_raw)</h3>
<p>Fabio reports the following metrics:</p>
<table>
  <thead>
      <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>{route}.rx</code></td>
          <td>timer</td>
          <td>Number of bytes received by fabio for TCP target</td>
      </tr>
      <tr>
          <td><code>{route}.tx</code></td>
          <td>timer</td>
          <td>Number of bytes transmitted by fabio for TCP target</td>
      </tr>
      <tr>
          <td><code>{route}</code></td>
          <td>timer</td>
          <td>Average response time for a route</td>
      </tr>
      <tr>
          <td><code>http.status.code.{code}</code></td>
          <td>timer</td>
          <td>Average response time for all HTTP(S) requests per status code</td>
      </tr>
      <tr>
          <td><code>notfound</code></td>
          <td>counter</td>
          <td>Number of failed HTTP route lookups</td>
      </tr>
      <tr>
          <td><code>requests</code></td>
          <td>timer</td>
          <td>Average response time for all HTTP(S) requests</td>
      </tr>
      <tr>
          <td><code>grpc.requests</code></td>
          <td>timer</td>
          <td>Average response time for all GRPC(S) requests</td>
      </tr>
      <tr>
          <td><code>grpc.noroute</code></td>
          <td>counter</td>
          <td>Number of failed GRPC route lookups</td>
      </tr>
      <tr>
          <td><code>grpc.conn</code></td>
          <td>counter</td>
          <td>Number of established GRPC proxy connections</td>
      </tr>
      <tr>
          <td><code>grpc.status.{code}</code></td>
          <td>timer</td>
          <td>Average response time for all GRPC(S) requests per status code</td>
      </tr>
      <tr>
          <td><code>tcp.conn</code></td>
          <td>counter</td>
          <td>Number of established TCP proxy connections</td>
      </tr>
      <tr>
          <td><code>tcp.connfail</code></td>
          <td>counter</td>
          <td>Number of TCP upstream connection failures</td>
      </tr>
      <tr>
          <td><code>tcp.noroute</code></td>
          <td>counter</td>
          <td>Number of failed TCP upstream route lookups</td>
      </tr>
      <tr>
          <td><code>tcp_sni.conn</code></td>
          <td>counter</td>
          <td>Number of established TCP+SNI proxy connections</td>
      </tr>
      <tr>
          <td><code>tcp_sni.connfail</code></td>
          <td>counter</td>
          <td>Number of failed TCP+SNI proxy connections</td>
      </tr>
      <tr>
          <td><code>tcp_sni.noroute</code></td>
          <td>counter</td>
          <td>Number of failed TCP+SNI upstream route lookups</td>
      </tr>
      <tr>
          <td><code>ws.conn</code></td>
          <td>gauge</td>
          <td>Number of actively open websocket connections</td>
      </tr>
  </tbody>
</table>
<h3 id="legend">Legend</h3>
<h4 id="timer">timer</h4>
<p>A timer counts events and provides an average throughput and latency number.
Depending on the metrics provider the aggregation happens either in the metrics library
(go-metrics: statsd, graphite) or in the system of the metrics provider (Circonus)</p>
<h4 id="counter">counter</h4>
<p>A counter counts events and provides an monotonically increasing value.</p>
<h4 id="gauge">gauge</h4>
<p>A gauge provides a current value.</p>
<h4 id="code">{code}</h4>
<p><code>{code}</code> is the three digit HTTP status code like <code>200</code>.</p>
<h4 id="route">{route}</h4>
<p><code>{route}</code> is a shorthand for the metrics name generated for a route
with the <code>metrics.names</code> template defined in
<a href="https://github.com/fabiolb/fabio/blob/master/fabio.properties">fabio.properties</a></p>

        
      </section>

    </article>
    

  </div>
</main>

    
    <footer class="site-footer">
      <div class="container">
        <a id="scroll-up" href="#"><i class="fa fa-angle-up"></i></a>

        <div class="row">
          <div class="col-md-6 col-sm-6">
            <p style="line-height: 26px;">
                Copyright &copy; 2020-2025 Education Networks of America. All rights reserved.</br>
                Copyright &copy; 2017-2020 Frank Schröder. All rights reserved.</br>
                Copyright &copy; 2015-2017 eBay Software Foundation.  All rights reserved</br>
                Last updated on 26 May 2025 23:11
            </p>
          </div>
          <div class="col-md-6 col-sm-6">
            <ul class="footer-menu">
              <li><a href="https://github.com/fabiolb/fabio/commits/master">Changelog</a></li>
              <li><a href="/contact/">Contact</a></li>
              <li>
                <a href="https://gohugo.io"><img src="/img/made-with-hugo.png" height="51px"></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2812942-5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

    gtag('config', 'UA-2812942-5');
    </script>

    
    <script src="/js/theDocs.all.min.js"></script>
    <script src="/js/custom.js"></script>

  </body>
</html>

